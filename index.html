<!doctype HTML>
<html>
<head>
<title>Test Driven Programming</title>
<meta charset="UTF-8"/>
<meta name="apple-mobile-web-app-capable" content="yes" />
<!--<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>-->
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
<link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-1.23.1.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/erlang.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet" type="text/css">
<link href='https://fonts.googleapis.com/css?family=Lato:400,100' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
<style>
html {
    -webkit-text-size-adjust: 100%;
}
code {
    white-space: pre-wrap;
    word-wrap: break-word;
    display: block;
    text-align: left;
}

body {
    margin-top: 5em;
    font-family: 'Source Sans Pro';
    font-weight: 100 !important;
    color: #333;
}
h1 {
    font-size: 5vw;
    text-align: center;
}
.slide {

}
#slides {
    margin: auto;
    max-width: 640px;
}
.slide img {
    display:block;
    text-align: center;
    margin: auto;
}
#slides table {
    border-collapse: collapse;
    border:#ccc 1px solid;
    margin: auto;
}

blockquote{
    display:block;
    background: #fff;
    padding: 15px 20px 15px 45px;
    margin: 0 0 20px;
    position: relative;

    /*Font*/
    font-family: Georgia, serif;
    font-size: 16px;
    line-height: 1.2;
    color: #666;
    text-align: left;

    /*Borders - (Optional)*/
    border-left: 15px solid #c76c0c;
    border-right: 2px solid #c76c0c;

    /*Box Shadow - (Optional)*/
    -moz-box-shadow: 2px 2px 15px #ccc;
    -webkit-box-shadow: 2px 2px 15px #ccc;
    box-shadow: 2px 2px 15px #ccc;
}

blockquote footer {
    text-align: right;
    font-style: italic;
}

blockquote::before{
    content: "\201C"; /*Unicode for Left Double Quote*/

    /*Font*/
    font-family: Georgia, serif;
    font-size: 60px;
    font-weight: bold;
    color: #999;

    /*Positioning*/
    position: absolute;
    left: 10px;
    top:5px;
}

blockquote::after{
    /*Reset to make sure*/
    content: "";
}

blockquote a{
    text-decoration: none;
    background: #eee;
    cursor: pointer;
    padding: 0 3px;
    color: #c76c0c;
}

blockquote a:hover{
    color: #666;
}

blockquote em{
    font-style: italic;
}
</style>
</head>
<body>
  <div id="slides">
    <div class="slide">
      <h1>Test driven design</h1>
      <h2>Hands-on experience and conclusions</h2>
    </div>
    <div class="slide">
      <h2>The “project”</h2>
      <ul>
        <li>Develop a new application framework for SGW.</li>
        <li>Daily code deliveries and nightly builds.</li>
        <li>Automated tests, full set of unit tests for delivered code.</li>
        <li>Heavy focus on design quality with design workshops, white board centric.</li>
        <li>Teams reviewed each others design ideas as well as code.</li>
        <li>Competitive setup...</li>
      </ul>
    </div>
    <div class="slide">
      <h2>Crash and burn</h2>
      <ul>
        <li>First design iteration – failed miserably</li>
        <li>Code was written first and unit tests last.</li>
        <li>Too big units with multiple purposes and many dependencies. The units were not that easy to test!</li>
        <li>Writing unit tests turned out to be a challenge and we found ourselves creating an over-complicated test-harness with complicated mock generation.</li>
        <li>Not so good code coverage.</li>
        <li>Our self esteem took a plunge</li>
      </ul>
    </div>
    <div class="slide">
      <h2>The insight</h2>
      <ul>
        <li>Design to make it testable!</li>
        <ul>
          <li>Dependency injection, decoupling.</li>
          <li>Separation of concern.</li>
          <li>Keep it clean! One unit, one purpose.</li>
          <li>Validate the existence and question the role and purpose of the unit.</li>
          <li>Requirement injection. Test the sturdiness of the design.</li>
        </ul>
        <li>A simple test-harness, easy to maintain and easy to use!</li>
        <li>Up-front design doesn’t work.</li>
        <ul>
          <li>By definition, if you are designing first, then you are not yet using what you have designed and you will not see the flaws until too late.</li>
          <li>You have to design incrementally as the system evolves.</li>
          <li>Unit tests are first users of your design/code.</li>
        </ul>
        <li>Only code what you need!!!!</li>
      </ul>
    </div>
    <div class="slide">
      <h2>Learning the lesson</h2>
      <ul>
        <li>The teams started to view the design from a test and usability perspective already from start.</li>
        <ul>
          <li>The test property became an important part of the design process. Test and usability was always evaluated.</li>
          <li>Testers (design test, FT) became involved in the design process and took part in the design workshops.</li>
          <li>Code and unit tests evolved in parallel. We discovered design problems earlier...</li>
        </ul>
        <li>It was fun!</li>
      </ul>
    </div>
    <div class="slide">
      <h2>The Bonus</h2>
      <ul>
        <li>The test approach improved both design and code as a side effect.</li>
        <ul>
          <li>Modularized and decoupled design</li>
          <li>Clear interfaces</li>
          <li>Re-usable parts</li>
          <li>Separation of concern</li>
          <li>Only needed code, nothing more, nothing less</li>
          <li>Easy trouble shooting</li>
          <li>...</li>
        </ul>
        <li>The gap between test and design vanished.</li>
      </ul>
    </div>
    <div class="slide">
    </div>
    <div class="slide">
      <h1>Test Driven Programming</h1>
      <blockquote>
        <p>Code without tests is bad code. It doesn’t matter how well written it is; it doesn’t matter how pretty or object-oriented or well-encapsulated it is. With tests, we can change the behavior of our code quickly and verifiably. Without them, we really don’t know if our code is getting better or worse.</p>
        <footer>Working Effectively with Legacy Code</footer>
      </blockquote>
    </div>
    <div class="slide">
      <h2>Why am I here?</h2>
      <p>I read some books...</p>
      <img src="the_software_craftsman.jpeg"/>
      <p>This book mentions TDD in every chapter so I got curious.</p>
    </div>
    <div class="slide">
      <img src="tdd_by_example.jpeg"/>
      <p>Kent Beck is the father of TDD.</p>
      <blockquote>
        I'm not a great programmer; I'm just a good programmer with great habits.
        <footer>Kent Beck</footer>
      </blockquote>
    </div>
    <div class="slide">
      <img src="working_effectively.jpeg"/>
      <p>This book aims to describe how to break out of the TDD programmers legacy code catch 22: You can't modify the code without having tests first and you can't test the code without modifying it.</p>
    </div>
    <div class="slide">
      <h2>So what is TDD?</h2>
      <blockquote>
        <ul>
          <li>Write a failing automated test before you write any code.</li>
          <li>Remove duplication.</li>
          <footer>Test Driven Development by Example -  Kent Beck</footer>
        </ul>
      </blockquote>
      <blockquote>
        <ul>
          <li>You are not allowed to write any production code unless it is to make a failing unit test pass.</li>
          <li>You are not allowed to write any more of a unit test than is sufficient to fail; and compilation failures are failures.</li>
          <li>You are not allowed to write any more production code than is sufficient to pass the one failing unit test.</li>
          <footer>The Three Rules Of Tdd - Robert C. Martin</footer>
        </ul>
      </blockquote>
    </div>
    <div class="slide">
      <h2>Red</h2>
      <img src="tomato.jpeg" style="width:100%; max-width:661px; max-height:496px;"/>
      <p>First we write a test that will teach us something about the code. And we make sure it fails.</p>
    </div>
    <div class="slide">
      <h2>Green</h2>
      <img src="cucumber.jpeg" style="width:100%; max-width:661px; max-height:496px;"/>
      <p>Then we make the simplest possible implementation to make the test pass.</p>
    </div>
    <div class="slide">
      <h2>Refactor</h2>
      <img src="cucumber_sliced.jpeg" style="width:100%; max-width:661px; max-height:496px;"/>
      <p>Now we have the safety net in place, we can iterate on refactoring the code with focus on removing duplication.</p>
    </div>
    <div class="slide">
      <h2>What is TDD not?</h2>
      <h3>TDD is not a test method, it's a development method.</h3>
      <blockquote>
        <p>So, in TDD we do not write tests. We write specifications. Executable specifications.</p>
        <footer>sustainabletdd.com</footer>
      </blockquote>
    </div>
    <div class="slide">
      <h2>Don't drink too much kool-aid</h2>
      <img src="koolaid.jpg" style="width:100%; max-width:283px; max-height:424px;"/>
      <blockquote>
        <ul>
          <li>Test first is like a fundamentalist religion</li>
          <li>Test first leads to 'design damage'</li>
          <li>Too much focus on unit tests other kinds are more useful</li>
        </ul>
        <footer>Emily Bache summarizing the points made by David Heinemeier Hansson in TDD is dead. Long live testing</footer>
      </blockquote>
      <p>TDD pushes you towards the dependency inversion principle, be aware of this and don't go crazy.</p>
    </div>
    <div class="slide">
      <h2>Where do I start?</h2>
      <p>Try a Kata</p>
      <p>It feels very slow in the start</p>
      <p>You really get to program more than you're used to</p>
    </div>
    <div class="slide">
      <h2>Self testing presentation</h2>
      <div id="qunit"></div>
      <div id="qunit-fixture"></div>
    </div>
    <div class="slide">
      <h2>Demo time</h2>
      <h3>Fibonacci!!</h3>
      <img src="fibonacci.jpg" style="width:100%; max-width:661px; max-height:496px;"/>
    </div>
<div id="code_sample">
<div class="slide">
<p>We write the simplest possible test case. This does not even compile since fib/0 is not defined.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib_zero_test() ->
    ?assertEqual(0, fib(0)).
</pre>
</div>

<div class="slide">
<p>Then we do the simplest possible implementation to get it to compile and the test to pass.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).
</pre>
</div>

<div class="slide">
<p>Let's continue to add another test that fails.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

</pre>
</div>

<div class="slide">
<p>Again, simplest possible solution to get to green.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).
</pre>
</div>

<div class="slide">
<p>We are not yet seeing any significant duplication so let's continue. To add yet another test.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).
</pre>
</div>

<div class="slide">
<p>Quick way of getting to green.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(N) ->
    1;

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).
</pre>
</div>

<div class="slide">
<p>More tests!</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(N) ->
    1.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).

fib_three_test() ->
    ?assertEqual(2, fib(3)).
</pre>
</div>

<div class="slide">
<p>To get to green I have to add back the special cases.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1;
fib(2) ->
    1;
fib(N) ->
    2.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).

fib_three_test() ->
    ?assertEqual(2, fib(3)).
</pre>
</div>

<div class="slide">
<p>Now we can with our knowledge of the algorithm detect that there is duplication going on. That 2 is really 1 + 1.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1;
fib(2) ->
    1;
fib(3) ->
    1 + 1.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).

fib_three_test() ->
    ?assertEqual(2, fib(3)).
</pre>
</div>

<div class="slide">
<p>The first 1 is actually a duplication of the previous statement.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1;
fib(2) ->
    1;
fib(N) ->
    fib(N-1) + 1.

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).

fib_three_test() ->
    ?assertEqual(2, fib(3)).
</pre>
</div>

<div class="slide">
  <p>And the second 1 is a duplcate of N-2.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

-module(fib).

fib(0) ->
    0;
fib(1) ->
    1;
fib(2) ->
    1;
fib(N) ->
    fib(N-1) + fib(N-2).

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).

fib_three_test() ->
    ?assertEqual(2, fib(3)).
</pre>
</div>

<div class="slide">
<p>Now we can remove the obsolete clause for 2.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1;
fib(N) ->
    fib(N-1) + fib(N-2).

fib_zero_test() ->
    ?assertEqual(0, fib(0)).

fib_one_test() ->
    ?assertEqual(1, fib(1)).

fib_two_test() ->
    ?assertEqual(1, fib(2)).

fib_three_test() ->
    ?assertEqual(2, fib(3)).
</pre>
</div>

<div class="slide">
<p>Now we can try to make a complete test for some fib numbers that will be a regression test.</p>
<pre>
-module(fib).
-include_lib("eunit/include/eunit.hrl").

fib(0) ->
    0;
fib(1) ->
    1;
fib(N) ->
    fib(N-1) + fib(N-2).

fib_long_list_test() ->
    Output = [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946, 17711, 28657, 46368, 75025, 121393, 196418, 317811, 514229, 832040, 1346269, 2178309],
    Input = lists:seq(0, length(Output)-1),
    ?assertEqual(length(Output), length(Input)),
    Res = lists:map(fun(In) -> fib(In) end, Input),
    ?assertEqual(Output, Res).
</pre>

<p>There you have it, an implementation of fib with driven by tests.<p/>
</p>Please do remember that this example is ment to examplify the flow of TDD and not a reasonable way of implementing fibonacci.</p>
</div>
</div><!-- code_sa<mple -->



  </div><!-- slides -->
</body>
<script>

function count_indent(string) {
    for(var i = 0; i < string.length; i++) {
        if(string[i] != " ") {
            return i ;
        }
    }
    return string.length;
}

function blockify(preTag) {
    var parent = preTag.parentNode;
    var lines = preTag.innerHTML.split('\n');
    var newDiv = document.createElement("code");
    newDiv.className = "erlang";
    lines.forEach(function(line) {
        var indent = count_indent(line);
        var div = document.createElement("code");

        if(indent > 0) {
            div.style['padding-left'] = (indent) + "ch";
            div.style['text-indent'] = (- indent) + "ch";
        }
        var trimmed = line.trim();
        if(trimmed == "") {
            trimmed = "&nbsp;";
        }
        var indentation = '<span>' + '&nbsp'.repeat(indent) + '</span>';
        div.innerHTML = indentation + trimmed;
        newDiv.appendChild(div);
    });

    preTag.parentNode.replaceChild(newDiv, preTag);
    hljs.highlightBlock(newDiv);
}

var preTags = [];
do {
    console.log("apa");
    preTags = document.getElementById("code_sample").getElementsByTagName("pre");
    blockify(preTags[0]);
} while(preTags.length > 0);

</script>
<script>
var slide = 0;
function showSlide(s) {
    var slides = document.getElementsByClassName("slide")
    var top = document.getElementById("slides");
    for(var i = 0; i < slides.length; i++) {
        if(i == slide || slides[slide].parentNode == slides[i] || (slides[slide].parentNode == slides[i].parentNode && i < slide && slides[i].parentNode != top)) {
            slides[i].style.display = ""
        } else {
            slides[i].style.display = "none"
        }
    }
}

function showAll() {
    var slides = document.getElementsByClassName("slide")
    for(var i = 0; i < slides.length; i++) {
        slides[i].style.display = ""
    }
}

document.onkeydown = function(e) {
    e = e || window.event;
    if (e.keyCode == '65') {
        showAll();
        return;
    } else if (e.keyCode == '37') {
        slide -= 1;
    } else if (e.keyCode == '39') {
        slide += 1;
    } else {
        return;
    }

    numSlides = document.getElementsByClassName("slide").length
    if(slide < 0) {
        slide = 0
    } else if(slide >= numSlides) {
        slide = numSlides-1;
    }
    showSlide(slide)
}

//showSlide(slide);
</script>
<script src="https://code.jquery.com/qunit/qunit-1.23.1.js"></script>
<script>
QUnit.test( "All quotes have origin", function( assert ) {
    var quotes = document.getElementsByTagName("blockquote");
    for(var i = 0; i < quotes.length; i++) {
        assert.equal(1, quotes[i].getElementsByTagName("footer").length);
    }
});
QUnit.test( "All images loaded", function( assert ) {
    var images = document.getElementsByTagName("img");
    for(var i = 0; i < images.length; i++) {
        assert.ok(images[i].naturalWidth > 0);
    }
});

</script>
</html>
